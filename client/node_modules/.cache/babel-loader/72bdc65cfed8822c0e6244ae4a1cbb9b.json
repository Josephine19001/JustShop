{"ast":null,"code":"import jwt from \"jsonwebtoken\";\nimport { SIGN_IN_FAILURE, SIGN_IN_REQUEST, SIGN_IN_SUCCESS, SIGN_UP_FAILURE, SIGN_UP_REQUEST, SIGN_UP_SUCCESS, SIGN_OUT_FAILURE, SIGN_OUT_REQUEST, SIGN_OUT_SUCCESS, FORGOT_PASSWORD_FAILURE, FORGOT_PASSWORD_REQUEST, FORGOT_PASSWORD_SUCCESS, RESET_PASSWORD_FAILURE, RESET_PASSWORD_REQUEST, RESET_PASSWORD_SUCCESS, GOOGLE_SIGN_IN_FAILURE, GOOGLE_SIGN_IN_REQUEST, GOOGLE_SIGN_IN_SUCCESS, UPDATE_USER_FAILURE, UPDATE_USER_REQUEST, UPDATE_USER_SUCCESS, BAN_FAILURE, BAN_REQUEST, BAN_SUCCESS, CHANGE_ROLE_FAILURE, CHANGE_ROLE_REQUEST, CHANGE_ROLE_SUCCESS, CHANGE_PASSWORD_FAILURE, CHANGE_PASSWORD_REQUEST, CHANGE_PASSWORD_SUCCESS, FIND_USER_BY_FAILURE, FIND_USER_BY_REQUEST, FIND_USER_BY_SUCCESS } from \"../../types\";\nexport const isValidToken = token => {\n  let decoded = jwt.decode(token);\n  return new Date(decoded.exp * 1000) > new Date() ? decoded : null;\n};\nconst initialState = {\n  currentUser: localStorage.getItem(\"USER-TOKEN\") ? isValidToken(localStorage.getItem(\"USER-TOKEN\")) : null,\n  token: localStorage.getItem(\"USER-TOKEN\") ? localStorage.getItem(\"USER-TOKEN\") : null,\n  error: \"\",\n  loading: false,\n  isAuthenticated: false\n};\n\nconst authenticationReducer = function (state = initialState, action) {\n  switch (action.type) {\n    case SIGN_IN_REQUEST:\n    case SIGN_UP_REQUEST:\n    case SIGN_OUT_REQUEST:\n    case FORGOT_PASSWORD_REQUEST:\n    case RESET_PASSWORD_REQUEST:\n    case CHANGE_PASSWORD_REQUEST:\n    case GOOGLE_SIGN_IN_REQUEST:\n    case BAN_REQUEST:\n    case CHANGE_ROLE_REQUEST:\n    case UPDATE_USER_REQUEST:\n    case FIND_USER_BY_REQUEST:\n      return { ...state,\n        loading: true,\n        isAuthenticated: false\n      };\n\n    case SIGN_IN_FAILURE:\n    case SIGN_UP_FAILURE:\n    case SIGN_OUT_FAILURE:\n    case FORGOT_PASSWORD_FAILURE:\n    case RESET_PASSWORD_FAILURE:\n    case CHANGE_PASSWORD_FAILURE:\n    case GOOGLE_SIGN_IN_FAILURE:\n    case BAN_FAILURE:\n    case CHANGE_ROLE_FAILURE:\n    case UPDATE_USER_FAILURE:\n    case FIND_USER_BY_FAILURE:\n      return { ...state,\n        loading: false,\n        error: action.payload,\n        currentUser: null,\n        isAuthenticated: false\n      };\n\n    case SIGN_UP_SUCCESS:\n    case SIGN_IN_SUCCESS:\n    case GOOGLE_SIGN_IN_SUCCESS:\n    case FIND_USER_BY_SUCCESS:\n      return { ...state,\n        loading: false,\n        token: action.payload.token,\n        currentUser: action.payload.user,\n        isAuthenticated: true\n      };\n\n    case SIGN_OUT_SUCCESS:\n      localStorage.removeItem(\"USER-TOKEN\");\n      return { ...state,\n        isAuthenticated: false,\n        loading: false,\n        currentUser: null,\n        token: \"\"\n      };\n\n    case RESET_PASSWORD_SUCCESS:\n    case FORGOT_PASSWORD_SUCCESS:\n    case UPDATE_USER_SUCCESS:\n    case BAN_SUCCESS:\n    case CHANGE_ROLE_SUCCESS:\n    case CHANGE_PASSWORD_SUCCESS:\n      return { ...state,\n        loading: false,\n        token: action.payload,\n        currentUser: action.payload,\n        isAuthenticated: true\n      };\n\n    default:\n      return { ...state\n      };\n  }\n};\n\nexport default authenticationReducer;","map":{"version":3,"sources":["/Users/Josephine/Documents/JustShop/client/src/redux/reducers/auth.ts"],"names":["jwt","SIGN_IN_FAILURE","SIGN_IN_REQUEST","SIGN_IN_SUCCESS","SIGN_UP_FAILURE","SIGN_UP_REQUEST","SIGN_UP_SUCCESS","SIGN_OUT_FAILURE","SIGN_OUT_REQUEST","SIGN_OUT_SUCCESS","FORGOT_PASSWORD_FAILURE","FORGOT_PASSWORD_REQUEST","FORGOT_PASSWORD_SUCCESS","RESET_PASSWORD_FAILURE","RESET_PASSWORD_REQUEST","RESET_PASSWORD_SUCCESS","GOOGLE_SIGN_IN_FAILURE","GOOGLE_SIGN_IN_REQUEST","GOOGLE_SIGN_IN_SUCCESS","UPDATE_USER_FAILURE","UPDATE_USER_REQUEST","UPDATE_USER_SUCCESS","BAN_FAILURE","BAN_REQUEST","BAN_SUCCESS","CHANGE_ROLE_FAILURE","CHANGE_ROLE_REQUEST","CHANGE_ROLE_SUCCESS","CHANGE_PASSWORD_FAILURE","CHANGE_PASSWORD_REQUEST","CHANGE_PASSWORD_SUCCESS","FIND_USER_BY_FAILURE","FIND_USER_BY_REQUEST","FIND_USER_BY_SUCCESS","isValidToken","token","decoded","decode","Date","exp","initialState","currentUser","localStorage","getItem","error","loading","isAuthenticated","authenticationReducer","state","action","type","payload","user","removeItem"],"mappings":"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","sourcesContent":["import jwt from \"jsonwebtoken\";\n\nimport {\n  SIGN_IN_FAILURE,\n  SIGN_IN_REQUEST,\n  SIGN_IN_SUCCESS,\n  SIGN_UP_FAILURE,\n  SIGN_UP_REQUEST,\n  SIGN_UP_SUCCESS,\n  SIGN_OUT_FAILURE,\n  SIGN_OUT_REQUEST,\n  SIGN_OUT_SUCCESS,\n  FORGOT_PASSWORD_FAILURE,\n  FORGOT_PASSWORD_REQUEST,\n  FORGOT_PASSWORD_SUCCESS,\n  RESET_PASSWORD_FAILURE,\n  RESET_PASSWORD_REQUEST,\n  RESET_PASSWORD_SUCCESS,\n  GOOGLE_SIGN_IN_FAILURE,\n  GOOGLE_SIGN_IN_REQUEST,\n  GOOGLE_SIGN_IN_SUCCESS,\n  UPDATE_USER_FAILURE,\n  UPDATE_USER_REQUEST,\n  UPDATE_USER_SUCCESS,\n  BAN_FAILURE,\n  BAN_REQUEST,\n  BAN_SUCCESS,\n  CHANGE_ROLE_FAILURE,\n  CHANGE_ROLE_REQUEST,\n  CHANGE_ROLE_SUCCESS,\n  CHANGE_PASSWORD_FAILURE,\n  CHANGE_PASSWORD_REQUEST,\n  CHANGE_PASSWORD_SUCCESS,\n  AuthenticateUsersInitialState,\n  FIND_USER_BY_FAILURE,\n  FIND_USER_BY_REQUEST,\n  FIND_USER_BY_SUCCESS,\n} from \"../../types\";\n\nexport const isValidToken = (token: any) => {\n  let decoded: any = jwt.decode(token);\n  return new Date(decoded.exp * 1000) > new Date() ? decoded : null;\n};\n\nconst initialState: AuthenticateUsersInitialState = {\n  currentUser: localStorage.getItem(\"USER-TOKEN\")\n    ? isValidToken(localStorage.getItem(\"USER-TOKEN\"))\n    : null,\n  token: localStorage.getItem(\"USER-TOKEN\")\n    ? localStorage.getItem(\"USER-TOKEN\")\n    : null,\n  error: \"\",\n  loading: false,\n  isAuthenticated: false,\n};\n\nconst authenticationReducer = function (state = initialState, action: any) {\n  switch (action.type) {\n    case SIGN_IN_REQUEST:\n    case SIGN_UP_REQUEST:\n    case SIGN_OUT_REQUEST:\n    case FORGOT_PASSWORD_REQUEST:\n    case RESET_PASSWORD_REQUEST:\n    case CHANGE_PASSWORD_REQUEST:\n    case GOOGLE_SIGN_IN_REQUEST:\n    case BAN_REQUEST:\n    case CHANGE_ROLE_REQUEST:\n    case UPDATE_USER_REQUEST:\n    case FIND_USER_BY_REQUEST:\n      return {\n        ...state,\n        loading: true,\n        isAuthenticated: false,\n      };\n    case SIGN_IN_FAILURE:\n    case SIGN_UP_FAILURE:\n    case SIGN_OUT_FAILURE:\n    case FORGOT_PASSWORD_FAILURE:\n    case RESET_PASSWORD_FAILURE:\n    case CHANGE_PASSWORD_FAILURE:\n    case GOOGLE_SIGN_IN_FAILURE:\n    case BAN_FAILURE:\n    case CHANGE_ROLE_FAILURE:\n    case UPDATE_USER_FAILURE:\n    case FIND_USER_BY_FAILURE:\n      return {\n        ...state,\n        loading: false,\n        error: action.payload,\n        currentUser: null,\n        isAuthenticated: false,\n      };\n    case SIGN_UP_SUCCESS:\n    case SIGN_IN_SUCCESS:\n    case GOOGLE_SIGN_IN_SUCCESS:\n    case FIND_USER_BY_SUCCESS:\n      return {\n        ...state,\n        loading: false,\n        token: action.payload.token,\n        currentUser: action.payload.user,\n        isAuthenticated: true,\n      };\n    case SIGN_OUT_SUCCESS:\n      localStorage.removeItem(\"USER-TOKEN\");\n      return {\n        ...state,\n        isAuthenticated: false,\n        loading: false,\n        currentUser: null,\n        token: \"\",\n      };\n    case RESET_PASSWORD_SUCCESS:\n    case FORGOT_PASSWORD_SUCCESS:\n    case UPDATE_USER_SUCCESS:\n    case BAN_SUCCESS:\n    case CHANGE_ROLE_SUCCESS:\n    case CHANGE_PASSWORD_SUCCESS:\n      return {\n        ...state,\n        loading: false,\n        token: action.payload,\n        currentUser: action.payload,\n        isAuthenticated: true,\n      };\n    default:\n      return { ...state };\n  }\n};\n\nexport default authenticationReducer;\n"]},"metadata":{},"sourceType":"module"}